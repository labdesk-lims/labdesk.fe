'################################################################################################
' This module provides functionalities to modify the graphic user interface behaviour and
' corporate design.
'################################################################################################

Option Compare Database
Option Explicit

Public Function AddAppProperty(strName As String, varType As Variant, varValue As Variant) As Boolean
'-------------------------------------------------------------------------------
' Function:     AddAppProperty
' Date:         2022 May
' Purpose:      Set an application property
' In:
' -> title:     Title of the application
' Out:          Done (T/F)
'-------------------------------------------------------------------------------
Dim dbs As Object, prp As Variant
Const conPropNotFoundError = 3270
 
Set dbs = CurrentDb
On Error GoTo Catch_Error
dbs.Properties(strName) = varValue
AddAppProperty = True
 
Exit_Function:
    Exit Function
 
Catch_Error:
    If Err = conPropNotFoundError Then
        Set prp = dbs.CreateProperty(strName, varType, varValue)
        dbs.Properties.Append prp
        Resume
    Else
        AddAppProperty = False
        Resume Exit_Function
    End If
End Function

Public Sub HideNavPane(bVisible As Boolean)
'-------------------------------------------------------------------------------
' Function:     HideNavPane
' Date:         2022 January
' Purpose:      Control the visibility of the Access Navigation Pane
' Parameters:
' -> bVisible   True/False - whether the Nav Pane should be visible or not
' Out:          -
'-------------------------------------------------------------------------------
    On Error GoTo Catch_Error
 
    If SysCmd(acSysCmdRuntime) = False Then
        If bVisible = True Then
            '            DoCmd.SelectObject acTable, , True
            DoCmd.SelectObject acModule, , True
        Else
            '            DoCmd.SelectObject acTable, , True
            DoCmd.SelectObject acModule, , True
            DoCmd.RunCommand acCmdWindowHide
        End If
    End If
 
Exit_Function:
    Exit Sub
Catch_Error:
    MsgBox "Error (mdlAutoExec - HideNavPane): " & Err.description, vbCritical, "Error"
    Resume Exit_Function
End Sub

Function DisableShift()
'-------------------------------------------------------------------------------
' Function:     HDisableShift
' Date:         2022 January
' Purpose:      This function disable the shift at startup
' Parameters:   -
' Out:          -
'-------------------------------------------------------------------------------

On Error GoTo errDisableShift

Dim db As DAO.database
Dim prop As DAO.Property
Const conPropNotFound = 3270

Set db = CurrentDb()

'This next line disables the shift key on startup.
db.Properties("AllowByPassKey") = False

'The function is successful.
Exit Function

errDisableShift:
'The first part of this error routine creates the "AllowByPassKey
'property if it does not exist.
If Err = conPropNotFound Then
Set prop = db.CreateProperty("AllowByPassKey", _
dbBoolean, False)
db.Properties.Append prop
Resume Next
Else
MsgBox "Function 'DisableShift' did not complete successfully."
Exit Function
End If
End Function

Function EnableShift()
'-------------------------------------------------------------------------------
' Function:     HDisableShift
' Date:         2022 January
' Purpose:      This function enables the shift at startup
' Parameters:   -
' Out:          -
'-------------------------------------------------------------------------------

On Error GoTo errEnableShift

Dim db As DAO.database
Dim prop As DAO.Property
Const conPropNotFound = 3270

Set db = CurrentDb()

'This next line of code disables the SHIFT key on startup.
db.Properties("AllowByPassKey") = True

'function successful
Exit Function

errEnableShift:
'The first part of this error routine creates the "AllowByPassKey
'property if it does not exist.
If Err = conPropNotFound Then
Set prop = db.CreateProperty("AllowByPassKey", _
dbBoolean, True)
db.Properties.Append prop
Resume Next
Else
MsgBox "Function 'EnableShift' did not complete successfully."
Exit Function
End If
End Function