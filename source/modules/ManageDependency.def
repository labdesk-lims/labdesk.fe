Attribute VB_Name = "ManageDependency"
Option Compare Database
Option Explicit

Public Function UploadDependency(ByVal fname As String) As Boolean
On Error GoTo Catch_Error
    Dim binary As Object
    Dim rs As Recordset
    
    CurrentDb.Execute "INSERT INTO dbfiles (FileName) VALUES('" & GetFileName(fname) & "')"
    
    Set rs = CurrentDb.OpenRecordset("SELECT binary FROM dbfiles WHERE FileName = '" & GetFileName(fname) & "'", dbOpenDynaset, dbSeeChanges)
    
    rs.Edit
    DbBlob.FileToBlob fname, rs!binary
    rs.Update
    rs.Close
    
    UploadDependency = True

Exit_Function:
    Set rs = Nothing
    Exit Function
Catch_Error:
    UploadDependency = False
    Resume Exit_Function
End Function

Public Function DeployDependency() As Boolean
On Error GoTo Catch_Error
    Dim obj As Object
    Dim rs As Recordset
    
    Set rs = CurrentDb.OpenRecordset("SELECT * FROM dbfiles", dbOpenDynaset, dbSeeChanges)
    
    rs.MoveFirst
    Do Until rs.EOF
        DbBlob.BlobToFile CurrentProject.Path & "\" & rs!filename, rs!binary
        rs.MoveNext
    Loop
    
    rs.Close
    
    DeployDependency = True
    
Exit_Function:
    Set rs = Nothing
    Exit Function
Catch_Error:
    DeployDependency = False
    Resume Exit_Function
End Function
