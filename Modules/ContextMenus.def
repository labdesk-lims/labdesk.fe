'################################################################################################
' This module will register context menus used in forms. Initialization will be done in module
' AutoExec.
'################################################################################################

Option Compare Database
Option Explicit

Public Sub InitContextMenuStd()
'-------------------------------------------------------------------------------
' Function:     InitContextMenuStd
' Date:         2022 January
' Purpose:      Registers the standard context menu
' In:           -
' Out:          -
'-------------------------------------------------------------------------------
    Dim cmbBar As CommandBar
    Dim cmbBtn_CreateNew, cmbBtn_Edit As CommandBarButton
    
On Error GoTo skip
    ' Delete context menu if already exists to register the new one
    CommandBars("StdContextMenu").Delete
skip:
    
    Set cmbBar = CommandBars.Add("StdContextMenu", msoBarPopup)
    
    ' Button to add record
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 18
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_add_record", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "add_record"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to apply a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 35
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_apply_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "apply_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to create a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 34
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_save_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "save_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to select columns
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 8
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_dlg", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_dlg"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to reset column size
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 6
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_std", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_std"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 29
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_audit_trail", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "audit_trail"
    cmbBtn_CreateNew.OnAction = "fnCall"
End Sub

Public Sub InitContextMenuStdDpl()
'-------------------------------------------------------------------------------
' Function:     InitContextMenuStdDpl
' Date:         2022 January
' Purpose:      Registers the standard context menu including duplication
' In:           -
' Out:          -
'-------------------------------------------------------------------------------
    Dim cmbBar As CommandBar
    Dim cmbBtn_CreateNew, cmbBtn_Edit As CommandBarButton
    
On Error GoTo skip
    ' Delete context menu if already exists to register the new one
    CommandBars("StdDplContextMenu").Delete
skip:
    
    Set cmbBar = CommandBars.Add("StdDplContextMenu", msoBarPopup)
    
    ' Button to add record
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 18
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_add_record", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "add_record"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to duplicate record
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 19
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_duplicate_record", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "duplicate_record"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to apply a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 35
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_apply_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "apply_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to create a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 34
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_save_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "save_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to select columns
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 8
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_dlg", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_dlg"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to reset column size
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 6
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_std", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_std"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 29
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_audit_trail", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "audit_trail"
    cmbBtn_CreateNew.OnAction = "fnCall"
End Sub

Public Sub InitContextMenuRqst()
'-------------------------------------------------------------------------------
' Function:     InitContextMenuRqst
' Date:         2022 January
' Purpose:      Registers the context menu for form request
' In:           -
' Out:          -
'-------------------------------------------------------------------------------
    Dim cmbBar As CommandBar
    Dim cmbBtn_CreateNew, cmbBtn_Edit As CommandBarButton
    
On Error GoTo skip
    CommandBars("RqstContextMenu").Delete
skip:
    
    Set cmbBar = CommandBars.Add("RqstContextMenu", msoBarPopup)
    
    ' Button to add record
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 18
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_add_record", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "add_record"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to create sub request
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 19
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_add_subrequest", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "add_subrequest"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to apply a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 35
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_apply_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "apply_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to create a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 34
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_save_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "save_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to select columns
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 8
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_dlg", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_dlg"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to reset column size
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 6
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_std", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_std"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to show preliminary report
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 44
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_print_report", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "show_report"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 64
    cmbBtn_CreateNew.Caption = GetTranslation("mdlContextMenu", "context_menu_std_print_sticker", GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "show_sticker"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 29
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_audit_trail", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "audit_trail"
    cmbBtn_CreateNew.OnAction = "fnCall"
End Sub

Public Sub InitContextMenuFlt()
'-------------------------------------------------------------------------------
' Function:     InitContextMenuFlt
' Date:         2022 January
' Purpose:      Registers the context menu for form filter
' In:           -
' Out:          -
'-------------------------------------------------------------------------------
    Dim cmbBar As CommandBar
    Dim cmbBtn_CreateNew, cmbBtn_Edit As CommandBarButton
    
On Error GoTo skip
    ' Delete context menu if already exists to register the new one
    CommandBars("FltContextMenu").Delete
skip:
    
    Set cmbBar = CommandBars.Add("FltContextMenu", msoBarPopup)
    
    ' Button to apply a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 35
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_apply_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "apply_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to create a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 34
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_save_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "save_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to select columns
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 8
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_dlg", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_dlg"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 29
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_audit_trail", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "audit_trail"
    cmbBtn_CreateNew.OnAction = "fnCall"
End Sub

Public Sub InitContextMenuFile()
'-------------------------------------------------------------------------------
' Function:     InitContextMenuFile
' Date:         2022 January
' Purpose:      Registers the file down- and upload context menu
' In:           -
' Out:          -
'-------------------------------------------------------------------------------
    Dim cmbBar As CommandBar
    Dim cmbBtn_CreateNew, cmbBtn_Edit As CommandBarButton
    
On Error GoTo skip
    ' Delete context menu if already exists to register the new one
    CommandBars("FileContextMenu").Delete
skip:
    
    Set cmbBar = CommandBars.Add("FileContextMenu", msoBarPopup)
    
    ' Button to down- or upload files
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 15
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_file_upload", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "upload_file"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to download files
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 14
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_file_download", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "download_file"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to open files
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 28
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_file_open", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "open_file"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 29
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_audit_trail", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "audit_trail_subform"
    cmbBtn_CreateNew.OnAction = "fnCall"
End Sub

Public Sub InitContextMenuSubStd()
'-------------------------------------------------------------------------------
' Function:     InitContextMenuSubStd
' Date:         2022 January
' Purpose:      Registers the standard context menu for sub forms
' In:           -
' Out:          -
'-------------------------------------------------------------------------------
    Dim cmbBar As CommandBar
    Dim cmbBtn_CreateNew, cmbBtn_Edit As CommandBarButton
    
On Error GoTo skip
    ' Delete context menu if already exists to register the new one
    CommandBars("StdSubContextMenu").Delete
skip:
    
    Set cmbBar = CommandBars.Add("StdSubContextMenu", msoBarPopup)
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 29
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_audit_trail", GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "audit_trail_subform"
    cmbBtn_CreateNew.OnAction = "fnCall"
End Sub

Public Sub InitContextMenuLic()
'-------------------------------------------------------------------------------
' Function:     InitContextMenuStd
' Date:         2022 January
' Purpose:      Registers the standard context menu
' In:           -
' Out:          -
'-------------------------------------------------------------------------------
    Dim cmbBar As CommandBar
    Dim cmbBtn_CreateNew, cmbBtn_Edit As CommandBarButton
    
On Error GoTo skip
    ' Delete context menu if already exists to register the new one
    CommandBars("LicContextMenu").Delete
skip:
    
    Set cmbBar = CommandBars.Add("LicContextMenu", msoBarPopup)
    
    ' Button to add record
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 18
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_add_record", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "add_record"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to activate record
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 277
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_activate_user", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "activate_user"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to deactivate record
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 330
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_deactivate_user", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "deactivate_user"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to apply a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 35
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_apply_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "apply_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    ' Button to create a filter
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 34
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_save_filter", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "save_filter"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to select columns
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 8
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_dlg", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_dlg"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Button to reset column size
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.FaceId = 6
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_clmn_std", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "clmn_std"
    cmbBtn_CreateNew.OnAction = "fnCall"
    
    'Audit trail
    Set cmbBtn_CreateNew = cmbBar.Controls.Add(msoControlButton)
    cmbBtn_CreateNew.BeginGroup = True
    cmbBtn_CreateNew.FaceId = 29
    cmbBtn_CreateNew.Caption = DbProcedures.GetTranslation("mdlContextMenu", "context_menu_std_audit_trail", DbConnect.GetDbSetting("language"))
    cmbBtn_CreateNew.Parameter = "audit_trail"
    cmbBtn_CreateNew.OnAction = "fnCall"
End Sub

Public Sub fnCall()
'----------------------------------------------------------------------------------------
'Function:      fnCall
' Date:         2022 January
' Purpose:      Calls the procedure in the form named in the parameter strAction
' In:           -
' Out:          -
'----------------------------------------------------------------------------------------
On Error GoTo Catch_Error
    Dim frmCurrentForm As Form
    Dim strAction As String
    
    strAction = CommandBars.ActionControl.Parameter
    
    Set frmCurrentForm = Screen.ActiveForm
    
    Select Case strAction
        Case "add_record"
            Forms(frmCurrentForm.name).AddRecord
        
        Case "activate_user"
            Forms(frmCurrentForm.name).ActivateUser
        
        Case "deactivate_user"
            Forms(frmCurrentForm.name).DeactivateUser
            
        Case "duplicate_record"
            Forms(frmCurrentForm.name).DuplicateRecord
        
        Case "add_subrequest"
            Forms(frmCurrentForm.name).AddSubRequest
        
        Case "show_report"
            Forms(frmCurrentForm.name).ShowReport
            
        Case "save_filter"
            Forms(frmCurrentForm.name).SaveFilter
            
        Case "apply_filter"
            Forms(frmCurrentForm.name).ApplyFilter
        
        Case "clmn_std"
            Forms(frmCurrentForm.name).ApplyClmnStd
        
        Case "upload_file"
            Forms(frmCurrentForm.name).Form("attachment_sbf").Form.UploadFile
        
        Case "download_file"
            Forms(frmCurrentForm.name).Form("attachment_sbf").Form.DownloadFile
        
        Case "open_file"
            Forms(frmCurrentForm.name).Form("attachment_sbf").Form.OpenFile
            
        Case "clmn_dlg"
            DoCmd.RunCommand acCmdUnhideColumns
        
        Case "show_sticker"
            Forms(frmCurrentForm.name).ShowSticker
        
        Case "audit_trail"
            DoCmd.OpenForm "~AuditTrail", acNormal, , , acFormReadOnly, acWindowNormal, Forms(frmCurrentForm.name).LinkedTable & ", " & Forms(frmCurrentForm.name).ID
            
        Case "audit_trail_subform"
            DoCmd.OpenForm "~AuditTrail", acNormal, , , acFormReadOnly, acWindowNormal, Forms(frmCurrentForm.name).Form(Screen.ActiveControl.Parent.name).Form.DataTable & ", " & Forms(frmCurrentForm.name).Form(Screen.ActiveControl.Parent.name).Form.ID
    End Select

Exit_Function:
    Exit Sub
Catch_Error:
    MsgBox "Error (mdlContextMenu - " & CommandBars.ActionControl.Parameter & "): " & Err.description, vbCritical, "Error"
    Resume Exit_Function
End Sub