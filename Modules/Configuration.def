Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
'################################################################################################
' This module holds the configuration information of the application. This includes public and
' global constants.
'################################################################################################

Option Compare Database
Option Explicit

' Database connection timeout in seconds
Private Const pConnectionTimeout = 3

' Application title shown as form title
Private Const pAppTitle = "LABDESK LIMS"

' Background worker timer interval in milliseconds
Private Const pBackgroundWorkerInterval = 3 * 60000

' Semantic Versioning according to https://semver.org/
' MAJOR-MINOR-PATCH
Private Const pBeVersion = "v1.0.0" 'Backend version
Private Const pFeVersion = "v1.0.0" 'Frontend version

' Identifiers used for reports and labels
Private Const pReportId = "RPT-" 'Identifier for selectable reports
Private Const pLabelId = "LBL-" 'Identifier for selectable labels

' Licence key file name
Private Const pLicenceFileName = "licence.lic"

' Temporary cache folder (the local user folder will be used) .labdesk
Private pCacheFolder As String

' System wide used encryption key
Private pEncryptionKey As String

' Set to true for demo mode to be activated
Private pDemoMode As Boolean

Public Property Get ConnectionTimeout() As Integer
    ConnectionTimeout = pConnectionTimeout
End Property

Public Property Get AppTitle() As String
    AppTitle = pAppTitle
End Property

Public Property Get BackgroundWorkerInterval()
    BackgroundWorkerInterval = pBackgroundWorkerInterval
End Property

Public Property Get BeVersion() As String
    BeVersion = pBeVersion
End Property

Public Property Get FeVersion() As String
    FeVersion = pFeVersion
End Property

Public Property Get LicenceFileName() As String
    LicenceFileName = pLicenceFileName
End Property

Public Property Get ReportId() As String
    ReportId = pReportId
End Property

Public Property Get LabelId() As String
    LabelId = pLabelId
End Property

Public Property Get CacheFolder() As String
    CacheFolder = pCacheFolder
End Property

Public Property Get EncryptionKey() As String
    EncryptionKey = pEncryptionKey
End Property

Public Property Get DemoMode() As Boolean
    DemoMode = pDemoMode
End Property

Public Property Let DemoMode(demo As Boolean)
    pDemoMode = demo
End Property

Public Property Get DSNLessTables() As Variant
    Dim a As Variant
    a = Array( _
    "filter", "translation", "setup", _
    "contact", "laboratory", "customer", "manufacturer", "smppoint", "smpcontainer", "smpmatrix", "material", _
    "cfield", "cvalidate", "condition", "uncertainty", "analysis", "attribute", "method_analysis", "method_smptype", "method", "qualification", "instrument_method", "department", "workplace", "instrument", "certificate", "attachment", "instype", "supplier", _
    "request", "measurement_cfield", "measurement", "measurement_condition", "view_request_measurement", _
    "profile_analysis", "profile", "request_analysis", "step", "state", "workflow", "smptype", "smpcondition", "smppreservation", "priority", "technique", _
    "batch", "btcposition", "storage", "strposition", "handbook", _
    "project", "project_member", "formulation", "component", "task", "workload", "view_task", _
    "view_measurement", _
    "users", "role", "role_permission", "permission", "traversal", "audit", "spa", "columns", _
    "view_labreport_details", _
    "view_attachment_revision", _
    "mailqueue", _
    "tableflag", "errorlog" _
    )
    DSNLessTables = a
End Property

Public Sub Init(DemoMode As Boolean, CacheFolder As String, EncryptionKey As String)
    pDemoMode = DemoMode
    pCacheFolder = CacheFolder
    pEncryptionKey = EncryptionKey
End Sub